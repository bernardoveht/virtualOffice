<div class="shadow searcher orange" [ngClass]="{'closed':!openSearch,'opened':openSearch}">
    <div class="searcher-header" (click)="openSearcher()">
        <div>
            <i class="fa-solid fa-magnifying-glass"></i>
            <span class="p-2">Buscar proyectos</span>
        </div>
        <div>
            <div *ngIf="openSearch"><i class="fa-solid fa-angle-down"></i></div>
            <div *ngIf="!openSearch"><i class="fa-solid fa-angle-up"></i></div>
        </div>
    </div>
    <form [formGroup]="searchForm" (ngSubmit)="handleSearch()">
        <div class="searcher-body">
            <div class="form-group">
                <label>SIPPE</label>
                <input class="form-control simple-control orange" formControlName="sippe" type="text" />
            </div>
            <div class="form-group">
                <label>Organismo</label>
                <div class="multiselect-custom">
                    <span class="multiselect-dropdown-count" *ngIf="searchForm.get('organismos')?.value">
                        <ng-container *ngIf="searchForm.get('organismos')?.value.length === 1">
                            {{searchForm.get('organismos')?.value[0].name | slice:0:20}} {{searchForm.get('organismos')?.value[0].name.length > 20 ? '...' : ''}}
                        </ng-container>
                        <ng-container *ngIf="searchForm.get('organismos')?.value.length > 1">
                            Seleccionado: {{searchForm.get('organismos')?.value.length}}
                        </ng-container>
                    </span>
                    <ng-multiselect-dropdown formControlName="organismos" [settings]="selectSettings" [data]="organismoList">
                    </ng-multiselect-dropdown>
                </div>
            </div>
            <div class="form-group">
                <label>Nombre del Proyecto</label>
                <input class="form-control simple-control orange" formControlName="name" type="text" />
            </div>
            <div class="form-group">
                <label>Planes</label>
                <div class="multiselect-custom">
                    <span class="multiselect-dropdown-count" *ngIf="searchForm.get('planes')?.value">
                        <ng-container *ngIf="searchForm.get('planes')?.value.length === 1">
                            {{searchForm.get('planes')?.value[0].name | slice:0:20}} {{searchForm.get('planes')?.value[0].name.length > 20 ? '...' : ''}}
                        </ng-container>
                        <ng-container *ngIf="searchForm.get('planes')?.value.length > 1">
                            Seleccionado: {{searchForm.get('planes')?.value.length}}
                        </ng-container>
                    </span>
                    <ng-multiselect-dropdown formControlName="planes" [settings]="selectSettings" [data]="planesList">
                    </ng-multiselect-dropdown>
                </div>
            </div>
            <div class="form-group date-picker-group" (click)="datePicker.toggle()">
                <label>Fecha</label>
                <input [weekdays]="true" ngbDatepicker #datePicker="ngbDatepicker" placeholder="Desde/Hasta..."
                    class="form-control simple-control orange" formControlName="fechaPresentacion" type="text" />
            </div>
        </div>
        <div class="searcher-footer">
            <button type="button" class="clean-btn btn rounded-btn orange" (click)="clearFilters()">Limpiar</button>
            <button type="submit" class="search-btn btn rounded-btn orange">Buscar</button>
            <div class="form-check form-switch">
                <input class="form-check-input" type="checkbox" role="switch" id="flexSwitchCheckDefault"
                    [value]="keepFilters" (change)="keepFilters=!keepFilters">
                <label class="form-check-label" for="flexSwitchCheckDefault">Mantener filtros</label>
            </div>
        </div>
    </form>
</div>